<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.3.1">

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Autonomous Collective Systems Laboratory" />
		<!-- Begin Jekyll SEO tag v2.0.0 -->
<title>ROS Installation for Pheeno - Autonomous Collective Systems Laboratory</title>
<meta property="og:title" content="ROS Installation for Pheeno" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="http://localhost:4000/ROS/pheeno-ros-installation-guide/" />
<meta property="og:url" content="http://localhost:4000/ROS/pheeno-ros-installation-guide/" />
<meta property="og:site_name" content="Autonomous Collective Systems Laboratory" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-12T21:49:01-04:00" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "ROS Installation for Pheeno",
    "datePublished": "2017-06-12T21:49:01-04:00",
    "description": "Introduction",
    "logo": "http://localhost:4000/siteicon.png",
    "url": "http://localhost:4000/ROS/pheeno-ros-installation-guide/"
  }
</script>
<!-- End Jekyll SEO tag -->

		
        
        
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="Autonomous Collective Systems Laboratory logo"></a>
				Autonomous Collective Systems Laboratory
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">Welcome</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level current">
							
							<a href="/ROS/pheeno-ros-installation-guide/">ROS</a>
							<ul>
								
									<li class="nav-item current"><a href="/ROS/pheeno-ros-installation-guide/">ROS Installation for Pheeno</a></li>
								
									<li class="nav-item "><a href="/ROS/pheeno-ros-guide/">pheeno_ros ROS Package Guide</a></li>
								
									<li class="nav-item "><a href="/ROS/pheeno-ros-server-guide/">pheeno_ros_server ROS Package Guide</a></li>
								
									<li class="nav-item "><a href="/ROS/pheeno-ros-sim-guide/">pheeno_ros_sim ROS Package Guide</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/controls/pheeno-controller-guide/">Controls</a>
							<ul>
								
									<li class="nav-item "><a href="/controls/pheeno-controller-guide/">Controller for Pheeno Navigation</a></li>
								
									<li class="nav-item "><a href="/controls/pheeno-observer-guide/">Using Pheeno's for Reliable Feedback</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/pheeno/pheeno_construction_content/">Pheeno</a>
							<ul>
								
									<li class="nav-item "><a href="/pheeno/pheeno_construction_content/">Pheeno Construction Guide</a></li>
								
									<li class="nav-item "><a href="/pheeno/raspberry_pi_content/">Setting Up Raspberry Pi with Camera for Pheeno</a></li>
								
									<li class="nav-item "><a href="/pheeno/pheeno_software_installation/">Pheeno Software Installation</a></li>
								
									<li class="nav-item "><a href="/pheeno/pheeno_programming_content/">Beginning to Program Pheeno</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>ROS</h2>
				<h3>ROS Installation for Pheeno</h3>
			</div>
			<article class="content">
				<h2 id="introduction">Introduction</h2>

<p>Currently, Pheeno is only supported by ROS Indigo; However, ROS Kinetic support is next. The following guide will show you how to install ROS and other necessary packages for the Raspberry Pi on the Pheeno.</p>

<h2 id="installing-ros-indigo">Installing ROS Indigo</h2>

<h3 id="setup-ros-repositories">Setup ROS Repositories</h3>

<p>First, we would like to pull packages from the official ROS repository, so we must add ROS to our list of Ubuntu repositories.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    sudo sh -c <span class="s1">'echo "deb http://packages.ros.org/ros/ubuntu jessie main" &gt; /etc/apt/sources.list.d/ros-latest.list'</span>
    wget https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -O - | sudo apt-key add -
</code></pre>
</div>

<p>From now on, updating and upgrading commands will result in listings and updates for ROS packages. We will do an initial update of the system with the newly added ROS source.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    sudo apt-get update
    sudo apt-get upgrade
</code></pre>
</div>

<h3 id="install-bootstrap-dependencies">Install Bootstrap Dependencies</h3>

<p>ROS requires some necessary Python packages. The first command will download Python specific packages that are good for development. As an aside, the Python packages we will be downloading are fantastic and should be learned irrespective of using ROS. Once those packages are installed, we will use pip, a Python package manager, to install ROS specific Python packages.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    sudo apt-get install python-pip python-setuptools python-yaml python-distribute python-docutils python-dateutil python-six
    sudo pip install rosdep rosinstall_generator wstool rosinstall
</code></pre>
</div>

<h3 id="initialize-rosdep">Initialize rosdep</h3>

<p>One of the previous packages installed called <code class="highlighter-rouge">rosdep</code> is a ROS package installer capable of fulfilling dependencies for many packages. Once installed from <code class="highlighter-rouge">pip</code>, we need to initialize it as such.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    sudo rosdep init
    rosdep update
</code></pre>
</div>

<h3 id="create-a-catkin-workspace">Create a catkin Workspace</h3>

<p>To begin the ROS installation, we need to create a workspace to build everything. In the main directory, we will create <code class="highlighter-rouge">ros_catkin_ws</code> to begin building ROS onto the Raspberry Pi.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    mkdir ~/ros_catkin_ws
    <span class="nb">cd</span> ~/ros_catkin_ws
</code></pre>
</div>

<p>To begin building, we will create a ROS installation file containing all the files and dependencies needed. The Raspberry Pi is underpowered and wonâ€™t really run the full desktop suite effectively. Therefore, we will just install the <code class="highlighter-rouge">ros_comm</code> package, which contains ROS, build, and basic communication libraries. <code class="highlighter-rouge">wstool</code>, a command line tool for maintaining workspaces, will then initialize a workspace around our <code class="highlighter-rouge">rosinstall</code> file.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    rosinstall_generator ros_comm --rosdistro indigo --deps --wet-only --exclude roslisp --tar &gt; indigo-ros_comm-wet.rosinstall
    wstool init src indigo-ros_comm-wet.rosinstall
</code></pre>
</div>

<h3 id="installing-unavailable-dependencies">Installing Unavailable Dependencies</h3>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    mkdir ~/ros_catkin_ws/external_src
    sudo apt-get install checkinstall cmake
    sudo sh -c <span class="s1">'echo "deb-src http://mirrordirector.raspbian.org/raspbian/ testing main contrib non-free rpi" &gt;&gt; /etc/apt/sources.list'</span>
    sudo apt-get update
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/ros_catkin_ws/external_src
    sudo apt-get build-dep console-bridge
    apt-get <span class="nb">source</span> -b console-bridge
    sudo dpkg -i libconsole-bridge0.2<span class="k">*</span>.deb libconsole-bridge-dev_<span class="k">*</span>.deb
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/ros_catkin_ws/external_src
    apt-get <span class="nb">source</span> -b lz4
    sudo dpkg -i liblz4-<span class="se">\*</span>.deb
</code></pre>
</div>

<h3 id="resolving-dependencies-with-rosdep">Resolving Dependencies with rosdep</h3>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/ros_catkin_ws
    rosdep install --from-paths src --ignore-src --rosdistro indigo -y -r --os<span class="o">=</span>debian:jessie
</code></pre>
</div>

<h3 id="building-the-catkin-workspace">Building the catkin Workspace</h3>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    sudo ./src/catkin/bin/catkin_make_isolated --install -DCMAKE_BUILD_TYPE<span class="o">=</span>Release --install-space /opt/ros/indigo -j2
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/indigo/setup.bash
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">echo</span> <span class="s2">"source /opt/ros/indigo/setup.bash"</span> &gt;&gt; ~/.bashrc
</code></pre>
</div>

<p>Thats it!</p>

<h2 id="installing-other-necessary-packages">Installing Other Necessary Packages</h2>

<p>The previous section explained the base installation of ROS Indigo on the Raspberry Pi. To use other packages is a bit tricky, but the following guide provides a convenient way of installing the packages on the Pheeno.</p>

<p>First, change back to the main directory.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span>
</code></pre>
</div>

<p>From here, we will make a directory called <code class="highlighter-rouge">catkin_ws</code> with a child directory called <code class="highlighter-rouge">src</code>.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    mkdir -p ~/catkin_ws/src
</code></pre>
</div>

<p>Finally, we change directory to the <code class="highlighter-rouge">src</code> dictory and initialize the workspace.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    catkin_init_workspace
</code></pre>
</div>

<p>This new catkin workspace will allow us to install other ROS packages.</p>

<h3 id="getting-the-rosserial-package">Getting the rosserial Package</h3>

<p><code class="highlighter-rouge">rosserial</code> is required for communication between the Raspberry Pi and the Teensy board. Our project requires three packages within the repository: <code class="highlighter-rouge">rosserial_client</code>, <code class="highlighter-rouge">rosserial_arduino</code>, and <code class="highlighter-rouge">rosserial_python</code>. To attain these files, we need to use <code class="highlighter-rouge">git clone</code> within the <code class="highlighter-rouge">src</code> folder.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    git clone -b indigo-devel https://github.com/ros_drivers/rosserial.git
</code></pre>
</div>

<p>The <code class="highlighter-rouge">-b</code> flag indicates that we would like to use the ROS Indigo specific branch of their respository. The default branch for the project is currently only for ROS Jade.</p>

<h3 id="getting-the-common_msgs-package">Getting the common_msgs Package</h3>

<p>The base installation of ROS only comes with standard messages (<code class="highlighter-rouge">std_msgs</code>). To get other message types such as Twist and action messages, we need to install the <code class="highlighter-rouge">common_msgs</code> package. Again, we will use <code class="highlighter-rouge">git clone</code>.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    git clone -b indigo-devel https://github.com/ros/common_msgs.git
</code></pre>
</div>

<p>We again pull from the ROS Indigo specific branch of the repository.</p>

<h3 id="getting-the-actionlib-package">Getting the actionlib Package</h3>

<p>This is an optional download entirely dependent on your use case. This is typically a default package for ROS; however, the <code class="highlighter-rouge">ros_comm</code> installation from before does not contain it. To download, we just need to clone the <code class="highlighter-rouge">indigo-devel</code> branch from the official ROS GitHub repository.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    git clone -b indigo-devel https://github.com/ros/actionlib.git
</code></pre>
</div>

<h3 id="getting-the-cv_bridge-package">Getting the cv_bridge Package</h3>

<p>The pacakges within the vision_opencv repository contain files for interfacing ROS with OpenCV. In ROS, the <code class="highlighter-rouge">image</code> message type is not compatible with any OpenCV functions. Therefore, the <code class="highlighter-rouge">cv_bridge</code> bridge package has some nice functions for converting <code class="highlighter-rouge">image</code> messages to OpenCV <code class="highlighter-rouge">Mat</code> variables and <em>vica versa</em>. To install, we will clone from the <code class="highlighter-rouge">ros-perception</code> GitHub repository from their ROS indigo development branch.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    git clone -b indigo-devel https://github.com/ros-perception/vision_opencv.git
</code></pre>
</div>

<h3 id="getting-the-pheeno_ros-package">Getting the pheeno_ros Package</h3>

<p>To get our ROS package for the Pheeno, we just need to clone it from our organization repository.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws/src
    git clone https://github.com/ACSLaboratory/pheeno_ros.git
</code></pre>
</div>

<h3 id="installing-the-packages">Installing the Packages</h3>

<p>Once the packages download, we can then install the packages using <code class="highlighter-rouge">catkin_make</code>. Remember to be within the <code class="highlighter-rouge">catkin_ws</code> directory and not the <code class="highlighter-rouge">src</code> directory when running the following commands.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/catkin_ws
    catkin_make -j2
    catkin_make install -j2
</code></pre>
</div>

<h2 id="installing-platformio">Installing PlatformIO</h2>

<p>PlatformIO is not a necessary package, but it is definitely helpful when deploying multiple Pheenos. Teensy requires a small GUI to upload files into the microcontroller. Using PlatformIO circumvents this by allowing uploaded code using the command line, which is great if you want to ssh into the Pheeno. If you are ok with using a GUI each time you want to upload code to the Teensy, then you are more than welcome to skip this section.</p>

<p>For those who do want the package, we just need to do a quick <code class="highlighter-rouge">pip</code> installation.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd
    </span>sudo pip install -U platformio
</code></pre>
</div>

<p>Next, create a directory that will act as a project folder. For example, we used the inventive name of <code class="highlighter-rouge">Teensy</code> as our project folder and then went into the directory.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    mkdir Teensy
    <span class="nb">cd </span>Teensy
</code></pre>
</div>

<p>From here, we will use PlatformIO to initialize the folder for work.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    platformio init --board teensy31
</code></pre>
</div>

<p>The <code class="highlighter-rouge">--board teensy31</code> argument provides the workspace the knowledege we will be working with a Teensy 3.2 board. The command above creates 2 empty directories and a project file. Place all the Arduino/Teensy library files within the <code class="highlighter-rouge">lib</code> directory and the actually file you wish to upload within the <code class="highlighter-rouge">src</code> directory. Now within the Teensy directory, run the following commands.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    <span class="nb">cd</span> ~/Teensy
    platformio run
    platformio run --target upload
</code></pre>
</div>

<p>Both PlatformIO commands will download some pertinent Teensy microcontroller files and then begin the upload process. <strong>The above commands only need to be run once</strong>. Every subsequent upload to the Teensy only requires the second command to be run (it is also much faster than the first run).</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>    platformio run --target upload
</code></pre>
</div>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
